#!/bin/sh
PREREQ=""
prereqs()
{
        echo "$PREREQ"
}
case $1 in
prereqs)
        prereqs
        exit 0
        ;;
esac

PROFILE="profile init-systemd /lib/systemd/** flags=(complain) 
{
	capability audit_write,	
	capability dac_override,
	capability dac_read_search,
	capability kill,
	capability mknod,
	capability net_admin,
	capability setuid,
	capability sys_admin,
	capability sys_boot,
	capability sys_module,
	capability sys_ptrace,
	capability sys_resource,
	capability sys_time,
	capability sys_tty_config,

	/dev/** rw,
	/etc/**	r,
	
	/lib/systemd/** rix,
	/lib/** rm,

	mount, 

	/proc/** rw,
	ptrace, 


	/run/**	rwcx -> run_default,
	signal, 

	/sys/** rwcx -> sys_default,
	
	/usr/ r,
	/usr/lib/x86_64-linux-gnu/**	rm,
	/usr/** rw,
	/var/** rw,
	/tmp/** rw,

	profile run_default flags=(complain){
		capability mknod,

		capability sys_ptrace,
	}

	profile sys_default flags=(complain){

		capability sys_ptrace,
	}
}"

mount -t securityfs none /sys/kernel/security
#echo "profile init-systemd /lib/systemd/** flags=(complain) {/lib/systemd/* ix, /{,usr/}{,s}bin/* pix, /opt/** Px,}" | /sbin/apparmor_parser -a
#echo "profile init-upstart /sbin/upstart flags=(complain) {}" | /sbin/apparmor_parser -a

echo "$PROFILE" | /sbin/apparmor_parser -a
#echo "profile init-upstart /sbin/upstart flags=(complain) {}" | /sbin/apparmor_parser -a

read -p "Enter a name: " name
echo "Hi, $name"
